import{s as e}from"./supabaseClient-B1HaFb4P.js";import{s as M}from"./email-cNRN05tX.js";async function N(o){try{const t=await(await fetch(`https://ipapi.co/${o}/json/`)).json();return{city:t.city,region:t.region,country:t.country_name}}catch{return{city:"",region:"",country:""}}}async function L(o,n){const{email:t,password:d,firstname:r,lastname:a,title:p,phone:f,country_code:y,nationality:w,address:h,city:g,state:_,zip:$,dob:b,occupation:E,ssn:U,marital_status:j,gender:z,username:S,acctype:s}=o,{data:D,error:i}=await e.auth.signUp({email:t,password:d});if(i)throw new Error(i.message);const c=D.user.id,G={id:c,full_name:`${r} ${a}`,title:p||null,firstname:r,lastname:a,phone:f||null,country_code:y||null,nationality:w||null,address:h||null,city:g||null,state:_||null,zip:$||null,dob:b||null,occupation:E||null,ssn:U||null,marital_status:j||null,gender:z||null,email:t,username:`${r} ${a}`||null},{error:l}=await e.from("profiles").insert(G);if(l)throw new Error(l.message);const u="10"+Math.floor(1e9+Math.random()*9e9),{error:m}=await e.from("accounts").insert({user_id:c,account_type:s,account_number:u,balance:0,interest_rate:s==="USD SAVING"?2.5:4});if(m)throw new Error(m.message);const I=await N(n);await M({name:`${r} ${a}`,email:t,accountNumber:u,ip:n,geo:I}),window.location.href="/user/auth"}export{L as s};
